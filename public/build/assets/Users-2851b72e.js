import{r as $,i as f,o as x,c as N,w as y,k as j,F as G,l as M,u as r,m as E,n as w,p as F,q,T as z,a as v,b as l,Z as O,d as u,h as n,N as i,x as V,y as C,z as Y}from"./app-ff6ec338.js";import{_ as L}from"./AuthenticatedLayout-528906eb.js";import{h as J}from"./moment-fbc5633a.js";import{s as k}from"./sweetalert.min-a0c0cac7.js";import{_ as h}from"./InputLabel-a599b044.js";import{_ as b}from"./TextInput-8530188a.js";import"./themeOverrides-9d5c4a9b.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./ResponsiveNavLink-9a120b43.js";import"./Copy-ca33d561.js";import"./PrimaryButton-2e8ef213.js";const Z={__name:"RadioButtonGroup",props:{options:{type:Array,required:!0},value:{type:String,default:"type"}},setup(_){const o=_,g=$(window.localStorage.getItem(o.value)??o.options[0].value);return f(()=>g.value,()=>{window.localStorage.setItem(o.value,g.value)}),(I,a)=>(x(),N(r(q),{value:g.value,"onUpdate:value":a[0]||(a[0]=c=>g.value=c)},{default:y(()=>[(x(!0),j(G,null,M(_.options,(c,S)=>(x(),N(r(E),{key:S,value:c.value},{default:y(()=>[w(F(c.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]))}},H=u("div",{class:"max-w-5xl mx-auto text-center"},[u("h2",{class:"text-xl md:text-2xl font-bold tracking-widest text-black"}," Users ")],-1),K={class:"p-3"},Q={class:"flex justify-around flex-wrap"},W={class:"my-2 max-w-[100px]"},X={class:"my-2"},ee={class:"my-2"},te={class:"my-2"},ae={class:"my-2"},le={class:"my-2"},ne={class:"p-3"},se=u("span",{class:"text-white"},"Goto",-1),ge={__name:"Users",props:{users:{type:Object},plans:Array,csrfToken:String,search:Object},setup(_){const o=_,g=[{value:"2",label:"Both"},{value:"0",label:"Personal"},{value:"1",label:"Enterprise"}],I=[{title:"ID",key:"id"},{title:"Name",key:"name"},{title:"Email",key:"email"},{title:"Type",key:"account_type",render(e){return e.account_type==0?n(i,{type:"success",bordered:!1},{default:()=>"Personal"+(e.enterprise.length>0?"-Invited":"")}):n(i,{type:"warning",bordered:!1},{default:()=>"Enterprise"})}},{title:"🛒",key:"plan",render(e){return e.account_type==0?n(i,{type:"info",bordered:!1},{default:()=>e.plan?`$${e.plan.price}`+(e.promo_code?`=> ${e.plan.price*.8}`:""):"$0"}):n(i,{type:"success",bordered:!1},{default:()=>`👨‍👩‍👧‍👦 ${e.available_employee}, `+(e.plan?`$${e.plan.price}`:"$0")})}},{title:"Promo",key:"promo_code"},{title:"Spent",key:"spent",render(e){return n(i,{style:{marginRight:"6px"},type:"success",bordered:!1},{default:()=>`$${e.spent}`})}},{title:"💲",key:"credit"},{title:"Generate",key:"count",render(e){return e.count>0?n(V,{class:"flex justify-center bg-gray-100 cursor-pointer hover:bg-gray-300 px-[10px] py-[5px] rounded",href:route("admin.user.photos",e.id)},{default:()=>`${e.count}`}):n(i,{class:"flex justify-center bg-gray-100 px-[10px] py-[5px] rounded",type:"warning",bordered:!1},{default:()=>"0"})}},{title:"BG",key:"photo_edit",render(e){if(!e.photo_edit)return;let t=e.photo_edit.filter(d=>d.bg_removed_img).length;return n(i,{class:"flex justify-center bg-gray-100 px-[10px] py-[5px] rounded",type:"warning",bordered:!1},{default:()=>`${e.click_count}:${t}`})}},{title:"✅",key:"id",render(e){if(e.photos.length!=0)return n(i,{type:"info",bordered:!1},{default:()=>e.photos[0].retouch==1?"Y":"N"})}},{title:"🔽",key:"photos",render(e){let t=0;return e.photos.length>0&&(t=e.photos.reduce((d,m)=>m.downloaded?d+JSON.parse(m.downloaded).length:d,0)),t>0?n(V,{class:"flex justify-center bg-gray-100 cursor-pointer hover:bg-gray-300 px-[10px] py-[5px] rounded",href:route("admin.user.photos.downloads",e.id)},{default:()=>`${t}`}):n(i,{class:"flex justify-center bg-gray-100 px-[10px] py-[5px] rounded",type:"success",bordered:!1},{default:()=>"0"})}},{title:"Ref💲",key:"id",render(e){return n(V,{class:(e.pendingPay==0?"bg-purple-200":"bg-blue-500 text-white hover:bg-blue-700")+" px-2 py-1 rounded",bordered:!1,href:route("admin.referrals.request.confirm",e.id)},{default:()=>`${e.totalPay}`})}},{title:"UTM Source",key:"utm_source"},{title:"UTM Medium",key:"utm_medium"},{title:"UTM Campaign",key:"utm_campaign"},{title:"UTM Content",key:"utm_content"},{title:"Date",key:"created_at",render(e){return J(e.created_at).format("MM/DD/YY hh:mm A")}},{title:"#",key:"id",render(e){if(!e.plan&&e.account_type==0)return[n(C,{type:"primary",class:"mr-1 mb-1",strong:!0,title:"Give Free Credit.",size:"small",onClick:()=>T(e)},{default:()=>"Give 💲"}),n(C,{type:e.last_payment=="refunded"?"error":"info",strong:!0,size:"small",title:"Refund this user's last payment.",disabled:!e.last_payment||e.last_payment=="refunded",onClick:()=>A(e)},{default:()=>e.last_payment=="refunded"?"Refunded":"Refund"})];if(!e.plan&&e.account_type==1)return n(C,{type:"primary",class:"mr-1 mb-1",strong:!0,title:"Give Free Credit.",size:"small",onClick:()=>T(e)},{default:()=>"Give 💲"})}}],a=z({id:o.search.id,email:o.search.email,name:o.search.name,account_type:o.search.account_type,utm_source:o.search.utm_source,utm_campaign:o.search.utm_campaign}),c=$({_token:o.csrfToken}),S=$(o.users.current_page),R=$(o.users.data??[]);f(()=>a.id,()=>{p(1)}),f(()=>a.email,()=>{p(1)}),f(()=>a.name,()=>{p(1)}),f(()=>a.account_type,()=>{p(1)}),f(()=>a.utm_source,()=>{p(1)}),f(()=>a.utm_campaign,()=>{p(1)});const p=e=>{S.value=e;let t=route("admin.users",{page:e});a.get(t,{onFinish:()=>console.log("finished.")})},B=e=>{console.log(e)},T=e=>{window.localStorage.getItem("plan")==4&&window.localStorage.setItem("plan","1");let d=[{value:"1",label:"Basic($25)"},{value:"2",label:"Premium($55)"},{value:"3",label:"Professional($155)"}];e.account_type==1&&(window.localStorage.setItem("plan","4"),d=[{value:"4",label:"Single($25)"}]);const m=document.createElement("div");Y({render:()=>n(Z,{options:d,value:"plan"})}).mount(m),k({text:"Please select plan:",content:m,buttons:["Cancel","Give"]}).then(U=>{U&&axios.put(route("admin.users.credit"),{...c.value,id:e.id,plan_id:window.localStorage.getItem("plan")}).then(()=>{e.plan=o.plans[Number(window.localStorage.getItem("plan"))-1],k("Sent successfuly!",`${e.name} received free credit.`,"success")})})},A=e=>{!e.last_payment||e.last_payment=="refunded"||k({title:"Are you sure?",text:"Are you sure want to refund "+e.name+"'s last payment",icon:"info",buttons:!0,dangerMode:!0}).then(t=>{t&&axios.post(route("admin.refund",e.id),{...c.value}).then(()=>{e.last_payment="refunded",k("Refunded successfuly!",`${e.name} will receive success mail.`,"success")})})};return(e,t)=>{const d=v("n-radio"),m=v("n-space"),U=v("n-radio-group"),D=v("n-data-table"),P=v("n-pagination");return x(),N(L,null,{header:y(()=>[H]),default:y(()=>[l(r(O),{title:"| Admin - Users"}),u("div",K,[u("div",Q,[u("div",W,[l(h,{for:"userId",value:"User ID"}),l(b,{placeholder:"Search by...",id:"suerId",type:"search",class:"mt-1 block w-full",modelValue:r(a).id,"onUpdate:modelValue":t[0]||(t[0]=s=>r(a).id=s)},null,8,["modelValue"])]),u("div",X,[l(h,{for:"email",value:"Email"}),l(b,{placeholder:"Search by...",id:"email",type:"search",class:"mt-1 block w-full",modelValue:r(a).email,"onUpdate:modelValue":t[1]||(t[1]=s=>r(a).email=s)},null,8,["modelValue"])]),u("div",ee,[l(h,{for:"name",value:"Name"}),l(b,{placeholder:"Search by...",id:"name",type:"search",class:"mt-1 block w-full",modelValue:r(a).name,"onUpdate:modelValue":t[2]||(t[2]=s=>r(a).name=s)},null,8,["modelValue"])]),u("div",te,[l(h,{for:"account_type",value:"Account Type"}),l(U,{class:"mt-1 block p-2 border-solid border-gray-400 border rounded-md shadow-sm",id:"account_type",value:r(a).account_type,"onUpdate:value":t[3]||(t[3]=s=>r(a).account_type=s),name:"radiogroup"},{default:y(()=>[l(m,null,{default:y(()=>[(x(),j(G,null,M(g,s=>l(d,{key:s.value,value:s.value,label:s.label},null,8,["value","label"])),64))]),_:1})]),_:1},8,["value"])]),u("div",ae,[l(h,{for:"utm_source",value:"UTM Source"}),l(b,{placeholder:"Search by...",id:"utm_source",type:"search",class:"mt-1 block w-full",modelValue:r(a).utm_source,"onUpdate:modelValue":t[4]||(t[4]=s=>r(a).utm_source=s)},null,8,["modelValue"])]),u("div",le,[l(h,{for:"utm_campaign",value:"UTM Campaign"}),l(b,{placeholder:"Search by...",id:"utm_campaign",type:"search",class:"mt-1 block w-full",modelValue:r(a).utm_campaign,"onUpdate:modelValue":t[5]||(t[5]=s=>r(a).utm_campaign=s)},null,8,["modelValue"])])]),l(D,{columns:I,data:R.value,"onUpdate:sorter":B},null,8,["data"]),u("div",ne,[l(P,{class:"justify-end","page-count":_.users.last_page,"show-quick-jumper":"",page:_.users.current_page,"onUpdate:page":p},{goto:y(()=>[se]),_:1},8,["page-count","page"])])])]),_:1})}}};export{ge as default};
